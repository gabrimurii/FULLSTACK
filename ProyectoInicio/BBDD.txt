
        - BASES DE DATOS -

    Sirven para almacenar y ordenar grandes cantidades de datos

    Almacena los datos ordenadamente

    Nos permiten actualizar la información de forma segura y confiable

    Ofrecen seguridad

    Evitan datos duplicados --> Con los ID (claves primarias)

        - SQL -

    SQL = Structured Query Language = Lenguaje de consulta estructurada

    Es el lenguaje más común para realizar consultas en una base de datos

    Creado en 1974

        - MySQL -

    Es un programa que se conoce como DBMS (Database Management System) y que utiliza SQL para realizar consultas a una base de datos

    Es un gestor de bases de datos

    Tenemos que instalar MySQL para poder trabajar con bases de datos


        - BBDD RELACIONALES -
    
    Con las que vamos a trabajar nosotros

    Hay más tipos, funcionales, documentales, transaccionales

    Cada registro o columna son datos relacionados

    Una base de datos de este tipo utiliza TABLAS

    Cada TABLA utiliza ROWS o FILAS que representan instancias de entidades y COLUMNAS que son atributos de estas entidades

            ID          NOMBRE          PUESTO

            1           JM              programador

            2           Gabriel         estudiante

            3           ...             ...

            4           ...             ...

    Tipos de relaciones 

            Clave primaria (PK) --> Atributo que tengo en una tabla y que aparecerá en la otra tabla como clave foránea y que me permite relacionar las dos tablas. NO SE PUEDE REPETIR UNA CLAVE PRIMARIA 

            Clave foránea (FK) --> Es un campo en una tabla que se corresponde con la clave primaria de otra tabla


        UNO A MUCHOS 1 : N

            Una instancia se refiere a los registros de muchas TABLAS

            Tabla CLIENTES con ID y NOMBRE

                        ID (PK)      NOMBRE

                        1            Juan

                        2            Andrea

            Tabla CITAS con ID, CLIENTELD y SERVICIOS

                        ID          CLIENTELD (FK)       SERVICIOS

                        1           1                    Corte Cabello
                        
                        2           2                    Tinte

                        3           1                    Corte Cabello

                        4           1                    Corte barba


        MUCHOS A UNO 1 : 1

            Sería mejor hacerlo todo en una tabla

            USUARIO                             PERFIL

                    ID      NOMBRE                  ID      USUARIO_ID          IMAGEN          URL

                    1       Juan                    1           1               120013.jpg      codigojuan.com

                    2       Andrea                  2           2               131313.jpg      codigoandrea.com


        MUCHOS A MUCHOS n : n

                        PROYECTOS                       PROYECTOSUSUARIOS                       USUARIOS

                    ID      PROYECTO                ID_USUARIO      ID_PROYECTO             ID      NOMBRE

                    1       Tienda Virtual          1               1                       1       Juan

                    2       Diseño Web              1               2                       2       Andrea

                                                    2               2

    
    DESCARGAMOS NODE.JS

        Versión 18.15.0 LTS

    DESCARGAMOS STACK AMP

        Apache + MySQL + PHP

        - Apache --> Servidor donde vamos a almacenar las BBDD

        - MySQL --> Gestos de BBDD

        - PHP --> Lenguaje de programación que me permite hacer uso y gestionar las BBDD

        Laravel lo instala todo a la vez, pero suele dar errores

        - APACHE -

            - Apachelounge.com 
            
            - Download --> Be sure you installed latest 14.34.31938 Visual C++ Redistributable Visual Studio 2015-2022 : vc_redist_x64

            - Apache 2.4.56 Win64 --> [Apache VS17 Win64 Binary] httpd-2.4.56-win64-VS17.zip  

            - Cogemos la carpeta llamada 'Apache24' de su interior y la pegamos en disco local C

            - Le cambiamos el nombre a 'Apache'

            - Abrimos la carpeta y nos metemos en 'conf' --> httpd.conf (click derecho --> Abrir con code)

            - Línea 37 cambiarle el nombre a 'Apache'

            - Ctrl + F (servername)  (línea 227) --> Descomentamos y cambiamos 'example' por 'localhost'

            - Vamos a la terminal de comandos

                - Vamos a la ruta donde tengamos la carpeta de Apache

                - cd Apache

                - cd bin 

                - .\httpd.exe 

            - Apache --> htdocs --> index --> Con Chrome

            - Para MAC --> HomeBrew, copiamos el link y lo pegamos en la terminal


            - Creamos un servicio

                - Abrimos la terminal de comandos y la ejecutamos como administrador

                - Navegamos hasta la carpeta

                - cd.. > cd.. > cd Apache/bin > .\httpd.exe -k install

                - Buscamos 'Servicios' en el buscador

                - Apache 2.4 --> Iniciar
            

        - PHP -

            - php.net/downloads

            - Old Stable PHP 8.1.17 > Windows downloads

            - VS16 x64 Thread Safe (2023-Mar-14 23:52:36) > zip

            - Descomprimimos en una carpeta llamada 'php' que creamos en el 'disco local C'

            - Hay que decirle a Apache, dónde va a encontrar mi carpeta PHP

            - Apache > conf > httpd.conf

            - Al final del todo ponemos este código

                LoadModule php_module "C:/php/php8apache2_4.dll"
                AddHandler application/x.httpd-php .php
                PHPIniDir "C:/php"

            - Reiniciamos el servicio de Apache

            - Servicios > Apache2.4 > Reiniciar servicio

            - En la carpeta de PHP copiamos el archivo 'php.ini-production' y renombramos a la copia como 'php.ini'

            - Lo abrimos con VSC

            CAMBIOS 

            - post_max_size = 8M > post_max_size = 20M

            - upload_max_filesize = 2M > upload_max_filesize = 20M

            - ;extension (descomentamos las siguientes)

                - extension=fileinfo
                - extension=gd
                - extension=mysqli

            - Reiniciamos Apache

            AÑADIMOS VARIABLES DE ENTORNO

            - Buscamos variables en el buscador
            - 'Editar variables de entorno'
            - Abajo pone "Variables de entorno"
            - Variables del sistema > Path > Editar
            - Nuevo > C:\php
            - Aceptar > Aceptar > Aceptar

        
        - MySQL -

            - https://dev.mysql.com/downloads/windows/installer/8.0.html
            - Windows (x86, 32-bit), MSI Installer (437.3M)
            - 'No thanks, just start my download.'
            - Developer default > Next
            - Next > Execute
            - 'Type and Networking' > Next > Next
            - Accounts and Roles
            - 'Root password 'FullstackPozuelo'
            - Next hasta Execute
            - 'Connect to server' > Contraseña > Check y aparece en verde arriba
            - Se abre MySQL Workbench > Vemos las tablas que creamos
            - Otra forma > TablePlus > Todo palante
            - Una vez dentro le damos al '+' y MySQL
            - Rellenamos los datos, le damos a test y si la conexión está bien, le damos a conectar
                - Nombre: MySQL localhost
                - color: negro
                - host: localhost
                - port: 3306
                - contraseña: FullstackPozuelo
                - test ... Ok
                - Connect
            
        - Crear una variable de entorno para MySQL -

            - Nueva variable del sistema > Path > Nuevo > C:\Program Files\MySQL\MySQL Server 8.0\bin
            - Me permite usar el lenguaje SQL en la terminal de comandos

        
    
    - POWERSHELL -

        Vamos a empezar a usar los comando de SQL

        Necesitan un ';' al final porque sino NO SE EJECUTA

        - Iniciar 

            mysql -u root -p

            contraseña ... (FullstackPozuelo)

            SHOW DATABASES; --> Nos enseña las BBDD 

                (Las sentencias van en mayúscula)
            
        - Crear BBDD

            CREATE DATABASE peluqueria;
            SHOW DATABASES;

        - Usar BBDD

            USE peluqueria;

        - Sacar tablar por pantalla

            SHOW TABLES;

        - Crear tablas

            ID          NOMBRE          PRECIO 

            ...         ...             ...

            CREATE TABLE servicios(
                id INT(11) NOT NULL AUTO_INCREMENT,
                nombre VARCHAR(60),
                precio DECIMAL(5,2),
                PRIMARY KEY (id)
            );

                id tipo_de_dato(máx_datos) NOT NULL AUTO_INCREMENT,
                siguiente columna 
                precio DECIMAL(Número máximo de nº, nº decimales)

        - Tipos de datos

            - Números

                - Enteros

                    -->     INT         -2100 Millones a 2100 Millones

                    -->     TINYINT     -128 a 127

                    -->     SMALLINT    

                    -->     MEDIUMINT

                    -->     BIGINT

                - Decimales 

                    --> FLOAT       Me muestra todos los decimales

                    --> DOUBLE      Valores decimales grandes

                    --> DECIMAL     Valores donde no se acepta redondeo
            
            - Cadena de texto

                    --> VARCHAR     Texto corto o texto que varía en su extensión (hasta 255)

                    --> CHAR        Corto, extensión fija (password encriptado)

                    --> TEXT        Texto Largo (una entrada de blog)

                    --> ENUM        Un valor de una lista enumerada

                    --> BLOB        Imágenes, sonidos y archivos comprimidos

            - Fechas y horas

                    --> DATE 

                    --> TIME

                    --> DATETIME

                    --> TIMESTAMP

                    --> YEAR

            - Los más comunes

                    --> INT
                    
                    --> TINYINT

                    --> DECIMAL

                    --> VARCHAR

                    --> TEXT
                    
                    --> DATETIME


        - Ver detalles de tabla

            DESCRIBE servicios;

        - REGISTROS (CRUD)

            - Crear / Leer / Actualizar / Eliminar

            - Create / Read / Update / Delete

            - CREAR REGISTROS (CREATE)

                - Insertar registros

                    INSERT INTO servicios (nombre,precio)
                    VALUES ("Corte de Cabello Hombre",15);

                    INSERT INTO servicios (nombre,precio)
                    VALUES ("Corte de Cabello Niño", 12),
                    ("Corte de Barba",8);

            - VER CONTENIDO DE UNA TABLA (READ)

                    SELECT*FROM servicios;

                    SELECT nombre FROM servicios; (solo el nombre)
                    SELECT nombre,precio FROM servicios; (nombre y precio)
                    
                    +----+-------------------------+--------+
                    | id | nombre                  | precio |
                    +----+-------------------------+--------+
                    |  1 | Corte de Cabello Hombre |  15.00 |
                    |  2 | Corte de Cabello Niño   |  12.00 |
                    |  3 | Corte de Barba          |   8.00 |
                    |  4 | Corte de Cabello Mujer  |  20.00 |
                    |  5 | Corte de Cabello Niña   |  11.00 |
                    |  6 | Tinte de pelo           |  30.00 |
                    |  7 | Lavado de pelo          |   5.00 |
                    |  8 | Mechas                  |  40.00 |
                    +----+-------------------------+--------+

                CONDICIONES

                    Servicios cuyo precio sea >=10

                        SELECT nombre,precio FROM servicios WHERE precio>=10; 

                    Mostrar id, nombre, precio de los id>3 y precio<22

                        SELECT * FROM servicios WHERE id>3 AND precio<22;

                    Ponemos AND cuando queremos que cumpla varias condiciones

                ORDENAR CONSULTA 

                        SELECT * FROM servicios ORDER BY precio;

            - ACTUALIZAR (UPDATE)

                    UPDATE servicios SET precio=20 WHERE id=1;

                    UPDATE servicios SET precio=100 WHERE id=2 OR id=3 OR id=4;

                    UPDATE servicios SET precio=50 WHERE id IN(3,5)

            - BORRAR (DELETE)

                    DELETE FROM servicios WHERE id=1;

                El id no se actualiza

                Si añadimos un nuevo valor se añadirá al final del todo

                Para eso tenemos que poner 
                    
                    INSERT INTO servicios(id, nombre, precio)
                    VALUES(1,"Cortecito",30);

            EJERCICIO

                Crear una tabla nueva (tiempos) dentro de 'peluqueria' con campos de 'id', 'idservicio', 'valor', 'prioridad' entre 0 y 5. Por cada registro quiero 9 valores de tiempos

                CREATE TABLE tiempos(
                    id INT(11) NOT NULL AUTO_INCREMENT,
                    idservicio INT(11) NOT NULL,
                    valor INT(3),
                    prioridad INT(1) NOT NULL,
                    PRIMARY KEY(id),
                    FOREIGN KEY(idservicio) REFERENCES servicios(id)
                );

                INSERT INTO tiempos (idservicio, valor, prioridad)
                -> VALUES (1, 10, 1),
                -> (2, 20, 2),
                -> (3, 30, 1),
                -> (4, 60, 5),
                -> (5, 40, 4),
                -> (6, 80, 5),
                -> (7, 15, 1),
                -> (8, 10, 1),
                -> (9, 15, 3);

                SELECT * FROM tiempos;


    - EJERCICIO -

    Crear una nueva BBDD 'aeropuerto'
    5 tablas: 'vuelo' 'compañia' 'pasajero' 'origen' 'destino'

    CREATE DATABASE aeropuerto;
    SHOW DATABASES;

    vuelo:                                      compania:                           pasajero:
        - idVuelo                                   - idCompania                        - idPasajero
        - nº vuelo                                  - nombre                            - nombre
        - compañia = idCompañia                     - idioma                            - apellidos
        - nº pasajeros                              - rating                            - dni
        - nº asientos                                                                   - nacionalidad
        - origen = idOrigen                                                             - telefono
        - destino = idDestino                                                           - idVuelo
                                                                                        - asiento
    
    origen:                                     destino:
        - idOrigen                                  - idDestino
        - ciudad                                    - ciudad
        - pais                                      - pais
        - zona horaria                              - zona horaria
        - idioma                                    - idioma
        - hora salida                               - hora llegada


        CREATE TABLE origen (
            idOrigen INT(11) NOT NULL AUTO_INCREMENT, 
            ciudad VARCHAR(60),
            pais VARCHAR(60),
            zonaHoraria TIMESTAMP,
            idioma CHAR(20),
            horaSalida DATETIME,            (BORRAR)
            PRIMARY KEY (idOrigen)
            );

                mysql> DESCRIBE origen;
                +-------------+-------------+------+-----+---------+----------------+
                | Field       | Type        | Null | Key | Default | Extra          |
                +-------------+-------------+------+-----+---------+----------------+
                | idOrigen    | int         | NO   | PRI | NULL    | auto_increment |
                | ciudad      | varchar(60) | YES  |     | NULL    |                |
                | pais        | varchar(60) | YES  |     | NULL    |                |
                | zonaHoraria | timestamp   | YES  |     | NULL    |                |
                | idioma      | char(20)    | YES  |     | NULL    |                |
                | horaSalida  | datetime    | YES  |     | NULL    |                |       (BORRAR)
                +-------------+-------------+------+-----+---------+----------------+

        CREATE TABLE destino (
            idDestino INT(11) NOT NULL AUTO_INCREMENT, 
            ciudad VARCHAR(60),
            pais VARCHAR(60),
            zonaHoraria TIMESTAMP,
            idioma CHAR(20),
            horaLlegada DATETIME,
            PRIMARY KEY (idDestino)
            );

                mysql> DESCRIBE destino;
                +-------------+-------------+------+-----+---------+----------------+
                | Field       | Type        | Null | Key | Default | Extra          |
                +-------------+-------------+------+-----+---------+----------------+
                | idDestino   | int         | NO   | PRI | NULL    | auto_increment |
                | ciudad      | varchar(60) | YES  |     | NULL    |                |
                | pais        | varchar(60) | YES  |     | NULL    |                |
                | zonaHoraria | timestamp   | YES  |     | NULL    |                |
                | idioma      | char(20)    | YES  |     | NULL    |                |
                | horaLlegada | datetime    | YES  |     | NULL    |                |
                +-------------+-------------+------+-----+---------+----------------+


        CREATE TABLE compania (
            idCompania INT(11) NOT NULL AUTO_INCREMENT,
            nombre VARCHAR(60),
            idioma CHAR(20),
            rating INT(1),
            PRIMARY KEY (idCompania)
        );     

                mysql> DESCRIBE compania;
                +------------+-------------+------+-----+---------+----------------+
                | Field      | Type        | Null | Key | Default | Extra          |
                +------------+-------------+------+-----+---------+----------------+
                | idCompania | int         | NO   | PRI | NULL    | auto_increment |
                | nombre     | varchar(60) | YES  |     | NULL    |                |
                | idioma     | char(20)    | YES  |     | NULL    |                |
                | rating     | int         | YES  |     | NULL    |                |
                +------------+-------------+------+-----+---------+----------------+


        CREATE TABLE vuelo (
            idVuelo INT(11) NOT NULL AUTO_INCREMENT,
            numeroVuelo INT(20),
            idCompania INT(11),
            numeroPasajeros INT(3),
            numeroAsientos INT(3),
            idOrigen INT(11),
            idDestino INT(11),  
            PRIMARY KEY (idVuelo),
            FOREIGN KEY(idCompania) REFERENCES compania(idCompania), 
            FOREIGN KEY(idOrigen) REFERENCES origen(idOrigen), 
            FOREIGN KEY(idDestino) REFERENCES destino(idDestino) 
        );

                mysql> DESCRIBE vuelo;
                +-----------------+------+------+-----+---------+----------------+
                | Field           | Type | Null | Key | Default | Extra          |
                +-----------------+------+------+-----+---------+----------------+
                | idVuelo         | int  | NO   | PRI | NULL    | auto_increment |
                | numeroVuelo     | int  | YES  |     | NULL    |                |
                | idCompania      | int  | YES  | MUL | NULL    |                |
                | numeroPasajeros | int  | YES  |     | NULL    |                |
                | numeroAsientos  | int  | YES  |     | NULL    |                |
                | idOrigen        | int  | YES  | MUL | NULL    |                |
                | idDestino       | int  | YES  | MUL | NULL    |                |
                +-----------------+------+------+-----+---------+----------------+


        CREATE TABLE pasajero (
            idPasajero INT(11) NOT NULL AUTO_INCREMENT,
            nombre VARCHAR(60),
            apellidos VARCHAR(100),
            dni VARCHAR(9),
            nacionalidad VARCHAR(20),
            telefono INT (9),
            idVuelo INT(11),
            asiento INT(2),
            PRIMARY KEY (idPasajero),
            FOREIGN KEY(idVuelo) REFERENCES vuelo(idVuelo)
        );

                mysql> DESCRIBE pasajero;
                +--------------+--------------+------+-----+---------+----------------+
                | Field        | Type         | Null | Key | Default | Extra          |
                +--------------+--------------+------+-----+---------+----------------+
                | idPasajero   | int          | NO   | PRI | NULL    | auto_increment |
                | nombre       | varchar(60)  | YES  |     | NULL    |                |
                | apellidos    | varchar(100) | YES  |     | NULL    |                |
                | dni          | varchar(9)   | YES  |     | NULL    |                |
                | nacionalidad | varchar(20)  | YES  |     | NULL    |                |
                | telefono     | int          | YES  |     | NULL    |                |
                | idVuelo      | int          | YES  | MUL | NULL    |                |
                | asiento      | int          | YES  |     | NULL    |                |
                +--------------+--------------+------+-----+---------+----------------+


        AGREGAR COLUMNA

                ALTER TABLE servicios ADD descripcion VARCHAR(100) NOT NULL

                SELECT * FROM servicios;

            Introducimos los registros necesarios

                mysql> SELECT * FROM servicios;
                +----+------------------------+--------+-------------+
                | id | nombre                 | precio | descripcion |
                +----+------------------------+--------+-------------+
                |  1 | Cortecito              |  30.00 |             |
                |  2 | Corte de Cabello Niño  | 100.00 |             |
                |  3 | Corte de Barba         |  50.00 |             |
                |  4 | Corte de Cabello Mujer | 100.00 |             |
                |  5 | Corte de Cabello Niña  |  50.00 |             |
                |  6 | Tinte de pelo          |  30.00 |             |
                |  7 | Lavado de pelo         |   5.00 |             |
                |  8 | Corte normal           |   4.00 |             |
                |  9 | Corte mixto            |  40.00 |             |
                +----+------------------------+--------+-------------+

        MODIFICAR COLUMNA

                ALTER TABLE servicios CHANGE descripcion nuevaDescripcion VARCHAR(40) NOT NULL

            Puedo cambiarle el nombre poniéndole el nombre antiguo seguido del nuevo 'descripcion nuevaDescripcion'

            Puedo cambiarle el () del tipo de variable pero NUNCA el tipo de variable. No puedo cambiar de VARCHAR a INT.

                mysql> SELECT * FROM servicios;
                +----+------------------------+--------+------------------+
                | id | nombre                 | precio | nuevaDescripcion |
                +----+------------------------+--------+------------------+
                |  1 | Cortecito              |  30.00 |                  |
                |  2 | Corte de Cabello Niño  | 100.00 |                  |
                |  3 | Corte de Barba         |  50.00 |                  |
                |  4 | Corte de Cabello Mujer | 100.00 |                  |
                |  5 | Corte de Cabello Niña  |  50.00 |                  |
                |  6 | Tinte de pelo          |  30.00 |                  |
                |  7 | Lavado de pelo         |   5.00 |                  |
                |  8 | Corte normal           |   4.00 |                  |
                |  9 | Corte mixto            |  40.00 |                  |
                +----+------------------------+--------+------------------+

        BORRAR COLUMNA

            ALTER TABLE servicios DROP COLUMN borrar;

                mysql> SELECT * FROM servicios;
                +----+------------------------+--------+------------------+--------+
                | id | nombre                 | precio | nuevaDescripcion | borrar |
                +----+------------------------+--------+------------------+--------+
                |  1 | Cortecito              |  30.00 |                  |      0 |
                |  2 | Corte de Cabello Niño  | 100.00 |                  |      0 |
                |  3 | Corte de Barba         |  50.00 |                  |      0 |
                |  4 | Corte de Cabello Mujer | 100.00 |                  |      0 |
                |  5 | Corte de Cabello Niña  |  50.00 |                  |      0 |
                |  6 | Tinte de pelo          |  30.00 |                  |      0 |
                |  7 | Lavado de pelo         |   5.00 |                  |      0 |
                |  8 | Corte normal           |   4.00 |                  |      0 |
                |  9 | Corte mixto            |  40.00 |                  |      0 |
                +----+------------------------+--------+------------------+--------+

                mysql> ALTER TABLE servicios DROP COLUMN borrar;
                Query OK, 0 rows affected (0.01 sec)
                Records: 0  Duplicates: 0  Warnings: 0

                mysql> SELECT * FROM servicios;
                +----+------------------------+--------+-------------+
                | id | nombre                 | precio | descripcion |
                +----+------------------------+--------+-------------+
                |  1 | Cortecito              |  30.00 |             |
                |  2 | Corte de Cabello Niño  | 100.00 |             |
                |  3 | Corte de Barba         |  50.00 |             |
                |  4 | Corte de Cabello Mujer | 100.00 |             |
                |  5 | Corte de Cabello Niña  |  50.00 |             |
                |  6 | Tinte de pelo          |  30.00 |             |
                |  7 | Lavado de pelo         |   5.00 |             |
                |  8 | Corte normal           |   4.00 |             |
                |  9 | Corte mixto            |  40.00 |             |
                +----+------------------------+--------+-------------+

        BORRAR TABLAS

            DROP TABLE origen; 

                mysql> SHOW TABLES;
                +----------------------+
                | Tables_in_peluqueria |
                +----------------------+
                | servicios            |
                | tiempos              |
                | origen               |
                +----------------------+

                mysql> DROP TABLE origen;
                Query OK, 0 rows affected (0.02 sec)

                mysql> SHOW TABLES;
                +----------------------+
                | Tables_in_peluqueria |
                +----------------------+
                | servicios            |
                | tiempos              |
                +----------------------+



    - EJERCICIO -

    Crear una nueva tabla llamada reservas con columas de 'idReserva' 'nombre' 'apellidos' 'hora' 'fecha' 'idServicio'
    Crear 5 instancias

        mysql> CREATE TABLE reservas(
            -> idReserva INT(11) NOT NULL AUTO_INCREMENT,
            -> nombre VARCHAR(40) NOT NULL,
            -> apellidos VARCHAR(80) NOT NULL,
            -> hora TIME DEFAULT NULL,
            -> fecha DATE DEFAULT NULL,
            -> idservicio INT(11),
            -> PRIMARY KEY (idReserva),
            -> FOREIGN KEY(idservicio) REFERENCES servicios(id)
            -> );
        Query OK, 0 rows affected, 2 warnings (0.04 sec)

            +-----------+-------------+--------------+----------+------------+------------+
            | idReserva | nombre      | apellidos    | hora     | fecha      | idservicio |
            +-----------+-------------+--------------+----------+------------+------------+
            |         1 | Gabriel     | Murillo Peña | 00:00:01 | 2023-03-29 |          1 |
            |         2 | Raquel      | Riesco Lopez | 00:00:15 | 2023-03-09 |          4 |
            |         3 | Jose Manuel | Profe Profe  | 00:00:30 | 2023-03-09 |          7 |
            |         4 | Adrian      | Murillo Peña | 00:00:45 | 2023-03-30 |          8 |
            |         5 | Miguel      | Murillo Peña | 20:30:00 | 2023-04-01 |          3 |
            |        14 | Pepe        | perez        | 12:01:13 | 2023-03-29 |          1 |
            +-----------+-------------+--------------+----------+------------+------------+

        Poner como valor CURTIME() y CURDATE para que seleccione el día y la hora actual 

        Para ambas juntas creo que es NOW()


        ORDENAR CONSULTA

            SELECT * FROM reservas WHERE idReserva != 2 ORDER BY apellidos;

        SELECCIONAR DATOS ENTRE DOS CONSULTAS    

            SELECT * FROM reservas WHERE idReserva BETWEEN 3 AND 4;


    FUNCIONES AGREGADORAS

        CONTADOR

            Cuenta el número de idReserva que hay por fecha y los agrupa

                SELECT COUNT(idReserva), fecha
                FROM reservas  
                GROUP BY fecha;

                +------------------+------------+
                | COUNT(idReserva) | fecha      |
                +------------------+------------+
                |                2 | 2023-03-29 |
                |                2 | 2023-03-09 |
                |                1 | 2023-03-30 |
                |                1 | 2023-04-01 |
                +------------------+------------+

                mysql> SELECT COUNT(idReserva), apellidos
                    -> FROM reservas
                    -> GROUP BY apellidos
                    -> ORDER BY apellidos DESC;

                +------------------+--------------+
                | COUNT(idReserva) | apellidos    |
                +------------------+--------------+
                |                1 | Riesco Lopez |
                |                1 | Profe Profe  |
                |                1 | perez        |
                |                3 | Murillo Peña |
                +------------------+--------------+


        SUMA

            Crea un alias de manera virtual (puntual)

                SELECT SUM(precio) AS totalServicios FROM servicios;

                +----------------+
                | totalServicios |
                +----------------+
                |         409.00 |
                +----------------+

            El alias totalServicios es un alias que se crea en es momento para mostrarlo y nada más, no existe en nuestra base de datos

        
        MINIMO / MAXIMO

            Calcular el mínimo o el máximo

                SELECT MIN(precio) AS precioMenor FROM servicios;

                +-------------+
                | precioMenor |
                +-------------+
                |        4.00 |
                +-------------+

                SELECT MAX(precio) AS precioMayor FROM servicios;

                +-------------+
                | precioMayor |
                +-------------+
                |      100.00 |
                +-------------+


        COMO BUSCAR EN BASE DE DATOS

            Seleccionar todos los servicios que contengan la pantalla Corte

                SELECT * FROM servicios WHERE nombre LIKE "%Corte%";

                +----+------------------------+--------+--------------------------------------------------------------------------+
                | id | nombre                 | precio | descripcion                                                              |
                +----+------------------------+--------+--------------------------------------------------------------------------+
                |  1 | Cortecito              |  30.00 | Pelo corto con maquinilla. Al 1, 2, 3 o 4                                |
                |  2 | Corte de Cabello Niño  | 100.00 | Distintos estilos para los más pequeños. Enséñanos una foto y lo haremos |
                |  3 | Corte de Barba         |  50.00 | Recorte de barba para cualquier longitud                                 |
                |  4 | Corte de Cabello Mujer | 100.00 | Los mejores looks para las mujeres de todas las edades                   |
                |  5 | Corte de Cabello Niña  |  50.00 | Para las más pequeñas, los estilos más modernos                          |
                |  8 | Corte normal           |   4.00 | Corte al más estilo tradicional                                          |
                |  9 | Corte mixto            |  40.00 | Para los indecisos                                                       |
                +----+------------------------+--------+--------------------------------------------------------------------------+

            Me busca el texto independientemente de su posición en el texto

            LIKE busca en la columna nombre todos los registros que contengan la palabra 'Corte'

            %corte  --> Todas las frases que terminen con 'corte'
            corte%  --> Todas las frases que comiencen con 'corte'
            %corte% --> independientemente de donde esté en el texto


        CONCATENAR COLUMNAS

            Crea un alias nuevo y junta campos de una tabla

                SELECT CONCAT(nombre, " ", apellidos) AS nombreCompleto FROM reservas;

                +-------------------------+
                | nombreCompleto          |
                +-------------------------+
                | Gabriel Murillo Peña    |
                | Raquel Riesco Lopez     |
                | Jose Manuel Profe Profe |
                | Adrian Murillo Peña     |
                | Miguel Murillo Peña     |
                | Pepe perez              |
                +-------------------------+

            Búsqueda + concatenacion

                SELECT * FROM reservas WHERE CONCAT(nombre, " ", apellidos) LIKE "%Murillo%";

                +-----------+---------+--------------+----------+------------+------------+
                | idReserva | nombre  | apellidos    | hora     | fecha      | idservicio |
                +-----------+---------+--------------+----------+------------+------------+
                |         1 | Gabriel | Murillo Peña | 00:00:01 | 2023-03-29 |          1 |
                |         4 | Adrian  | Murillo Peña | 00:00:45 | 2023-03-30 |          8 |
                |         5 | Miguel  | Murillo Peña | 20:30:00 | 2023-04-01 |          3 |
                +-----------+---------+--------------+----------+------------+------------+

            Mostrar hora, fecha y nombre concatenado con apellido

                SELECT hora, fecha, CONCAT(nombre, " ", apellidos) AS nombreCompleto FROM reservas;

                +----------+------------+-------------------------+
                | hora     | fecha      | nombreCompleto          |
                +----------+------------+-------------------------+
                | 00:00:01 | 2023-03-29 | Gabriel Murillo Peña    |
                | 00:00:15 | 2023-03-09 | Raquel Riesco Lopez     |
                | 00:00:30 | 2023-03-09 | Jose Manuel Profe Profe |
                | 00:00:45 | 2023-03-30 | Adrian Murillo Peña     |
                | 20:30:00 | 2023-04-01 | Miguel Murillo Peña     |
                | 12:01:13 | 2023-03-29 | Pepe perez              |
                +----------+------------+-------------------------+

        
        MULTIPLES CONDICIONES

            Selecciona multiples valores

                SELECT * FROM reservas WHERE idReserva IN(1, 3, 4);

                +-----------+-------------+--------------+----------+------------+------------+
                | idReserva | nombre      | apellidos    | hora     | fecha      | idservicio |
                +-----------+-------------+--------------+----------+------------+------------+
                |         1 | Gabriel     | Murillo Peña | 00:00:01 | 2023-03-29 |          1 |
                |         3 | Jose Manuel | Profe Profe  | 00:00:30 | 2023-03-09 |          7 |
                |         4 | Adrian      | Murillo Peña | 00:00:45 | 2023-03-30 |          8 |
                +-----------+-------------+--------------+----------+------------+------------+

            Selecciona multiples valores con multiples condiciones    
                
                SELECT * FROM reservas WHERE idReserva IN(1, 3, 4) AND idServicio=7;

                +-----------+-------------+-------------+----------+------------+------------+
                | idReserva | nombre      | apellidos   | hora     | fecha      | idservicio |
                +-----------+-------------+-------------+----------+------------+------------+
                |         3 | Jose Manuel | Profe Profe | 00:00:30 | 2023-03-09 |          7 |
                +-----------+-------------+-------------+----------+------------+------------+


    REGLAS DE NORMALIZACIÓN

        Reglas que hay que llevar a cabo para estructurar bien nuestra base de datos
        
        Optimizan nuestras bases de datos

        Existen muchas reglas de normalización pero las tres primeras son las más importantes

        Siguen un orden a la hora de cumplirlas, si no cumple la anterior no puede cumplir la siguiente


            PRIMERA REGLA DE NORMALIZACIÓN (1NF)

                Una columna solo puede tener un valor y no debe haber grupos repetidos

            
            SEGUNDA REGLA DE NORMALIZACIÓN (2NF)

                Una vez aplicada la primera regla aplicamos la segunda

                Para evitar valores duplicados, creamos un 'id' y lo enlazamos con una tabla externa

                2NF se utiliza en Llaves primarias compuestas

                Cuando tenemos datos repetidos en una tabla (por ejemplo, un nombre), lo metemos en una tabla nueva y lo relacionamos con un ID

            TERCERA REGLA DE NORMALIZACIÓN (3NF)

                Se centra en las columnas que están fuera de la PK y la FK

                No tiene sentido añadir campos que no tengan relación con la tabla

    
    DENORMALIZACIÓN

        En algunos casos no se cumplen las Normas De Normalización.

        Por ejemplo, si un cliente tiene dos números de teléfono.

        Una tabla con dos columnas, una con teléfono y otra con teléfono2

    
    DIAGRAMAS ER (Diagramas Entidad Relación)

        Son diagramas que contienen información de las tablas y las relaciones entre las mismas

        Hay herramientas de pago y gratuitas para generar estos diagramas

        1º Nombre de la tabla --- CLIENTES
        2º Campos de la tabla --- idCliente / nombre / apellidos / teléfono / email
        3º ¿Cuál es mi PK?    --- idCliente


        +----------------+          +---------------+           +--------------+            +----------------------+
            clientes                    servicios                    citas                      citaServicios
        +----------------+          +---------------+           +--------------+            +----------------------+
            idCliente (PK)              idservicio (PK)             idCita (PK)                 idCitaServicio (PK)
            nombre                      nombre                      fecha                       idCita  (FK)
            apellidos                   precio                      hora                        idServicio  (FK)
            telefono                +---------------+               idCliente (FK)
            email                                               +--------------+ 
        +----------------+                                      

        Un cliente puede tener muchas citas 1:N --> + idCliente (clientes) -> idCliente (citas)

        Muchas citas pueden tener muchos servicios y viceversa N:N --> <- idCita (citas) -> idCita (citaServicios)

        Muchos servicios pueden tener muchas citaServicios N:N --> <- idServicio (cita servicios) -> idServicio (servicios)




    UNIR DOS TABLAS = INNER JOIN

        Muestra por pantalla dos tablas relacionadas entre sí mediante su id

            SELECT * FROM tablaActual
            INNER JOIN tablaReferencia ON tablaReferencia.idReferencia = tablaActual.idActualReferencia
                =
            LEFT JOIN

            RIGHT JOIN

            mysql> SELECT * FROM citas
                -> INNER JOIN clientes ON clientes.idClientes = citas.idClientes;
            +---------+------------+----------+------------+------------+---------+----------------+-----------+-------------------------------+
            | idCitas | fecha      | hora     | idClientes | idClientes | nombre  | apellidos      | telefono  | email                         |
            +---------+------------+----------+------------+------------+---------+----------------+-----------+-------------------------------+
            |       2 | 2023-03-30 | 14:06:50 |          1 |          1 | Gabriel | Murillo Peña   | 666666666 | gabrimurii@gmail.com          |
            |       4 | 2023-04-01 | 14:36:18 |          1 |          1 | Gabriel | Murillo Peña   | 666666666 | gabrimurii@gmail.com          |
            |       1 | 2023-03-30 | 14:06:50 |          2 |          2 | Raquel  | Riesco Lopez   | 777777777 | raquelriesco@gmail.com        |
            |       3 | 2023-03-30 | 14:06:50 |          3 |          3 | Adrian  | Perez Gonzalez | 888888888 | adrianperezgonzalez@gmail.com |
            +---------+------------+----------+------------+------------+---------+----------------+-----------+-------------------------------+


    UNIR MÁS DE DOS TABLAS

            mysql> SELECT * FROM citasServicios
            -> LEFT JOIN citas ON citas.idCitas = citasServicios.idCitas
            -> LEFT JOIN servicios ON servicios.id = citasServicios.idServicios;
            +------------------+---------+-------------+---------+------------+----------+------------+------+-----------------------+--------+---------------------------------------------------+
            | idCitasServicios | idCitas | idServicios | idCitas | fecha      | hora     | idClientes | id   | nombre                | precio | descripcion                                       |
            +------------------+---------+-------------+---------+------------+----------+------------+------+-----------------------+--------+---------------------------------------------------+
            |                1 |       1 |           9 |       1 | 2023-03-30 | 14:06:50 |          2 |    9 | Corte mixto           |  40.00 | Para los indecisos                                |
            |                2 |       2 |           7 |       2 | 2023-03-30 | 14:06:50 |          1 |    7 | Lavado de pelo        |   5.00 | Lavado de pelo y masaje con los mejores productos |
            |                3 |       3 |           5 |       3 | 2023-03-30 | 14:06:50 |          3 |    5 | Corte de Cabello Niña |  50.00 | Para las más pequeñas, los estilos más modernos   |
            +------------------+---------+-------------+---------+------------+----------+------------+------+-----------------------+--------+---------------------------------------------------+


    SACAR X PARAMETROS POR PANTALLA 

            mysql> SELECT citas.idCitas, servicios.nombre, citas.fecha FROM citasServicios
            -> LEFT JOIN citas ON citas.idCitas = citasServicios.idCitas
            -> LEFT JOIN servicios ON servicios.id = citasServicios.idServicios;
            +---------+-----------------------+------------+
            | idCitas | nombre                | fecha      |
            +---------+-----------------------+------------+
            |       1 | Corte mixto           | 2023-03-30 |
            |       2 | Lavado de pelo        | 2023-03-30 |
            |       3 | Corte de Cabello Niña | 2023-03-30 |
            +---------+-----------------------+------------+
    









    EJERCICIO

    Crear una base de datos 'cine'

    Gestiona las 'salas' lsa 'butacas' las 'películas' por sala el 'ticket' de película, los 'actores' y el 'director'

    Teniendo una entrada, sepa toda la información

        salas
        - idSalas
        - numero 
        - numeroButacas
        - idCategoria (estandar, premium...)

        butacas
        - idButacas
        - fila 
        - asiento

        categoria
        - idCategoria
        - estilo
        - precio

        clientes
        - idClientes
        - nombre
        - apellidos
        - dni

        sesiones (horarios)
        - idSesiones
        - dia 
        - hora
        - idSala
        - idPeliculas

        peliculas
        - idPeliculas
        - nombre
        - duración
        - presupuesto
        - idGenero

        genero
        - idGenero
        - nombre

        actores
        - idActores
        - nombre
        - apellidos
        - papel
        - sueldo

        directores
        - idDirectores
        - nombre
        - apellidos
        - numeroPeliculas
        - sueldo

        ticket
        - idTicket
        - idClientes
        - idSesiones (idSalas + idPeliculas)
        - idActores
        - idDirectores
        - idButacas
























